<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

	<title>rangeMapper</title> 
	<meta name="description" content="rangeMapper: A platform for the study of macroecology of life history traits">
	<meta name="author" content="Mihai Valcu">
	<meta name="keywords" content="macroecology, GIS, species richness, life history traits, rangeMapper, Aves,R, spatial analysis" />
	
	<link rel="stylesheet" href="style/style.css" type="text/css" />
		
	<!-- google-analytics -->
	<script type="text/javascript">

			  var _gaq = _gaq || [];
			  _gaq.push(["_setAccount", "UA-25987540-1"]);
			  _gaq.push(["_trackPageview"]);

			  (function() {
					var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
					ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
					var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
			  })();
	</script>
	
	<script src="style/syntaxHighlighter.js"> </script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="scripts/galleria/galleria-1.2.8.min.js"></script>
	
	
	
	
	</head>
	<body style="max-width:1024px">	
	
<div id="layout-leftBar"> <ul id="layout-leftBar" class="level1">
 <h4> rangeMapper </h4>
 <li><a href= "index.html" > home </a> </li>
 <li><a href= "faq.html" > faq </a> </li>
 <li><a href= "gui.html" > gui </a> </li>
 <li><a href= "bibliography.html" > bibliography </a> </li>
 <h4> Examples </h4>
 <li class="submenu"><a> Getting started </a> <ul class="level2"> <li><a href= "Species_Richness.html" > Species_Richness </a></li>
<li><a href= "on-the-fly reprojection.html" > on-the-fly reprojection </a></li>
<li><a href= "Range_Traits.html" > Range_Traits </a></li>
<li><a href= "Range_Traits2.html" > Range_Traits2 </a></li> </ul> </li>
 <li class="submenu"><a> Aggregate assambladges </a> <ul class="level2"> <li><a href= "SQL_functions.html" > SQL_functions </a></li>
<li><a href= "R_functions.html" > R_functions </a></li> </ul> </li>
 <li class="submenu"><a> Subsetting </a> <ul class="level2"> <li><a href= "Species.html" > Species </a></li>
<li><a href= "Assambladge.html" > Assambladge </a></li>
<li><a href= "Species & Assambladge.html" > Species & Assambladge </a></li> </ul> </li>
 <h4> Case studies </h4>
 <li class="submenu"><a> Valcu et al 2012 </a> <ul class="level2"> <li><a href= "appendix_S2.html" > appendix_S2 </a></li>
<li><a href= "appendix_S3.html" > appendix_S3 </a></li>
<li><a href= "appendix_S4.html" > appendix_S4 </a></li>
<li><a href= "appendix_S5.html" > appendix_S5 </a></li> </ul> </li>
 <li class="submenu"><a> NatureServe </a> <ul class="level2"> <li><a href= "Canidae.html" > Canidae </a></li>
<li><a href= "Falconidae.html" > Falconidae </a></li> </ul> </li>
 </ul></div>

<div id="layout-content-box"> <div id="layout-banner"> <div id="layout-title">rangeMapper</div><div id="layout-description">A platform for the study of macroecology of life history traits</div></div>
<h6> This script runs with  R version 2.15.1 (2012-06-22) & rangeMapper 0.1-9) </h6>

<h2>Appendix S4 </h2>

<p>Supporting information in  <em>Valcu, M., Dale, J., and Kempenaers, B. (2012). <br/>
rangeMapper: a platform for the study of macroecology of life-history traits. <br/>
Global Ecology and Biogeography 21, 945-951.</em></p>

<h2>Case study 3: The influence of grid size on the relationship between species richness and body size </h2>

<pre><code class="r">require(rangeMapper)
# 1) SET UP PROJECT 
td = tempdir()

#Location of the vector(*.shp) breeding ranges on disk
branges = system.file(package = &quot;rangeMapper&quot;, &quot;extdata&quot;, 
                                    &quot;wrens&quot;, &quot;vector_combined&quot;)

r = readOGR(branges, &quot;wrens&quot;, verbose = FALSE)

# Define grid size vector of increasing grid sizes. 
gridSizes = round(seq(from = 1, to = 4, length.out = 10), 2)

# Load life history data
data(wrens)
</code></pre>

<pre><code class="r"># 2) Perform log10(median_body_mass) ~ sqrt(species_richness) regression
 # for each grid size

output = list()

for( i in 1:length(gridSizes) ) {

  dbcon = rangeMap.start(file = &quot;temp.sqlite&quot;, dir = td, overwrite = TRUE)
  global.bbox.save(con = dbcon, bbox = branges)
  # The grid size is set along the values in &#39;gridSizes&#39;
  gridSize.save(dbcon, gridSize = gridSizes[i]) 
  canvas.save(dbcon) 

  processRanges(spdf = r, con =  dbcon, ID = &quot;sci_name&quot;, metadata = rangeTraits() )

  bio.save(con = dbcon, loc = wrens, ID = &quot;sci_name&quot;)

# When rangeMap.save is called without extra arguments species richness
# is saved by default
  rangeMap.save(dbcon) 

  rangeMap.save(dbcon, FUN = &#39;median&#39;, biotab = &quot;wrens&quot;, biotrait = &quot;body_mass&quot;, 
    tableName = &quot;median_body_mass&quot;)

  map = rangeMap.fetch(dbcon, 
    c(&quot;species_richness&quot;, &quot;median_body_mass&quot;))
  map = as(map, &quot;SpatialPointsDataFrame&quot;)
  map = map[!is.na(map$median_body_mass) &amp; 
            !is.na(map$species_richness), ]


# Perform OLS regression and save the output
# NOTE: In order to perform a spatial simultaneous autoregressive error regression
#  see &#39;errorsarlm &#39; function and the auxiliary neighbours list functions in &#39;spdep&#39; package.
  output[[i]] = lm(log10(median_body_mass) ~ sqrt(species_richness), data= map)

  dbDisconnect(dbcon)
}

</code></pre>

<pre><code class="r"># 3) Extract regression parameters

prm = lapply(output, function(x) data.frame(slope = coef(x)[2], ci2.5 = confint(x)[2, 1], ci97.5 = confint(x)[2, 2]))
prm = do.call(rbind, prm)

# 4) PLOT
if (!require(Hmisc)) stop(&quot;package Hmisc is required for plotting&quot;)
with(prm, errbar(gridSizes, slope, ci2.5, ci97.5))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<p><footer>  Website built with <code>R version 2.15.1 (2012-06-22) , knitr 0.7 &amp; markdown 0.5.2</code> </footer> <br/>
                <footer> Last update <code>09/11/2012 13:58</code> , <a href="mailto:valcu@orn.mpg.de">valcu@orn.mpg.de</a> </footer> </p>

</div></div> <div id="footer"> <div id="footer-badge"> <a href="http://validator.w3.org/check?uri=referer"> <img style="border:0;width:88px;height:31px" src="http://www.w3.org/Icons/valid-xhtml11-blue" alt="Valid XHTML 1.1" height="31" width="88" /></a></div></div></body></html>
